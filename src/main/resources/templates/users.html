<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <meta http-equiv="Cache-Control" content="no-store, no-cache, must-revalidate, max-age=0"/>
    <meta http-equiv="Pragma" content="no-cache"/>
    <meta http-equiv="Expires" content="0"/>

    <title>Usuarios</title>
    <link rel="stylesheet" th:href="@{/css/styles.css}">
</head>
<body>
<div th:if="${msg}" class="alert ok" th:text="${msg}"></div>
<div th:if="${error}" class="alert error" th:text="${error}"></div>
<div th:replace="~{fragments/header :: topbar}"></div>

<div class="container">
    <h1>Usuarios</h1>

    <div class="row">
        <a class="btn" href="/home">Volver</a>

        <form method="post" action="/logout">
            <button class="btn danger" type="submit">Logout</button>
        </form>
    </div>

    <div class="card" th:if="${#lists.isEmpty(users)}">
        <p>No hay usuarios para mostrar (o el backend devolvió lista vacía).</p>
    </div>

    <div class="card" th:if="${!#lists.isEmpty(users)}">
        <table>
            <thead>
            <tr>
                <th>ID</th>
                <th>Username</th>
                <th>Rol</th>
                <th>Acciones</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="u : ${users}">
                <td th:text="${u.id}"></td>
                <td th:text="${u.username}"></td>
                <td th:text="${u.role}"></td>
                <td>
                    <form th:action="@{'/users/' + ${u.id} + '/delete'}" method="post">
                        <button type="submit" class="btn danger">Eliminar</button>
                    </form>
                </td>
            </tr>
            </tbody>
        </table>

        <p class="hint">
            Nota: Eliminar requiere <code>ROLE_ADMIN</code> en el backend. Si el usuario no es ADMIN, vas a ver 403.
        </p>
    </div>
</div>
</body>
</html>
